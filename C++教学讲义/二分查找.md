
# 二分查找模板函数

## lower_bound
**查找第一个等于或大于x的元素**

## upper_bound
**查找第一个大于x的元素**

## 常用示例

```cpp
#include<iostream>
#include<algorithm>

int idx_l = lower_bound(a, a+n, x) - a  // 查找第一个大于等于x的元素
int idx_u = upper_bound(a, a+n, x) - a  // 查找第一个大于x的元素

// 第一个等于x的元素
if(a[idx_l]==x) cout << idx_l;

// 查找最后一个等于x的元素
if(a[idx_u-1]==x) cout << idx_u - 1;

// 查找最后一个等于或小于x的元素
cout << idx_u - 1;

// 查找最后一个小于x的元素
cout << idx_l - 1;

// 计算序列中x的个数
cout << idx_u - idx_l;

```
---

# 题解

## 例1. P1024 [NOIP 2001 提高组] 一元三次方程求解

## 题目描述

有形如：$a x^3 + b x^2 + c x + d = 0$  这样的一个一元三次方程。给出该方程中各项的系数（$a,b,c,d$ 均为实数），并约定该方程存在三个不同实根（根的范围在 $-100$ 至 $100$ 之间），且根与根之差的绝对值 $\ge 1$。要求由小到大依次在同一行输出这三个实根(根与根之间留有空格)，并精确到小数点后 $2$ 位。

提示：记方程 $f(x) = 0$，若存在 $2$ 个数 $x_1$ 和 $x_2$，且 $x_1 < x_2$，$f(x_1) \times f(x_2) < 0$，则在 $(x_1, x_2)$ 之间一定有一个根。

## 输入格式

一行，$4$ 个实数 $a, b, c, d$。

## 输出格式

一行，$3$ 个实根，从小到大输出，并精确到小数点后 $2$ 位。

## 输入输出样例 #1

### 输入 #1

```
1 -5 -4 20
```

### 输出 #1

```
-2.00 2.00 5.00
```

## 说明/提示

**【题目来源】**

NOIP 2001 提高组第一题

```cpp
#include<iostream>
using namespace std;

double a,b,c,d;
double fun(double x)
{
    return a*x*x*x+b*x*x+c*x+d;
}

double bin_search(double l, double r){
    while(r-l>0.001){
        double mid = (l+r)/2.0;
        double f_mid = fun(mid);
        if(f_mid==0) return mid;
        else if(f_mid*fun(l)<0){
            r = mid;
        }
        else{
            l = mid + 0.001;
        }
    }
    return l;
}

int main(){
    cin >> a >> b >> c >> d;

    // -100到100之间枚举所有端点值
    double left, right, res;
    left = fun(-100);
    for(int i=-99;i<=100;i++){
        right = fun(i);
        if(left==0) printf("%.2f ", (double)i-1);
        else if(left*right < 0){
            // 在[i-1,i)区间查找根
            res = bin_search((double)i-1, (double)i);
            printf("%.2f ", res);
        }

        left = right;
    }

    return 0;
}
```


<!--stackedit_data:
eyJoaXN0b3J5IjpbLTEwNDM2OTgxNzcsLTE0NDI4MzEwODMsLT
g5NDEyMjU4MywtMzYxOTY4MTI5XX0=
-->